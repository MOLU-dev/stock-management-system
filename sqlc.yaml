version: "2"

sql:
  - schema: "internal/db/migration"
    queries: "internal/db/queries/"
    engine: "postgresql"
    gen:
      go:
        package: "db"
        out: "internal/db/sqlc"

        # Use standard database/sql instead of pgx strict types
        sql_package: "database/sql"

        # Keep code simple
        emit_params_struct_pointers: false
        emit_result_struct_pointers: false

        emit_json_tags: true
        emit_interface: true
        emit_enum_valid_method: true
        emit_all_enum_values: true
        json_tags_case_style: "snake"
        

        overrides:
          # ---- Time fields ----
          - column: "*.created_at"
            go_type: "time.Time"
          - column: "*.updated_at"
            go_type: "time.Time"
          - column: "*.movement_date"
            go_type: "time.Time"
          - column: "*.approved_at"
            go_type: "time.Time"
          - column: "*.counted_at"
            go_type: "time.Time"
          - column: "*.scanned_at"
            go_type: "time.Time"
          - column: "*.changed_at"
            go_type: "time.Time"
          - column: "*.start_time"
            go_type: "time.Time"
          - column: "*.end_time"
            go_type: "time.Time"
          - column: "*.order_date"
            go_type: "time.Time"
          - column: "*.expected_delivery_date"
            go_type: "time.Time"
          - column: "*.transfer_date"
            go_type: "time.Time"
          - column: "*.expected_completion_date"
            go_type: "time.Time"
          - column: "*.adjustment_date"
            go_type: "time.Time"
          - column: "*.start_date"
            go_type: "time.Time"
          - column: "*.end_date"
            go_type: "time.Time"
          # These date fields are nullable - let sqlc handle them automatically
          # - column: "*.last_reorder_date"
          #   go_type: "time.Time"
          # - column: "*.expiry_date"
          #   go_type: "time.Time"
          # - column: "*.manufacturing_date"
          #   go_type: "time.Time"
          # - column: "*.last_counted_date"
          #   go_type: "time.Time"
          - column: "*.incident_date"
            go_type: "time.Time"
          - column: "*.forecast_date"
            go_type: "time.Time"
          - column: "*.last_counted"
            go_type: "time.Time"
          - column: "*.next_scheduled"
            go_type: "time.Time"
          - column: "*.last_order_date"
            go_type: "time.Time"
          - column: "*.last_updated"
            go_type: "time.Time"

          # ---- Decimal / money fields ----
          - column: "*.unit_price"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.cost_price"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.total_amount"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.total_price"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.adjustment_value"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.total_value"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.estimated_value"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.rating"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.performance_rating"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.confidence_level"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.variance_threshold"
            go_type: "github.com/shopspring/decimal.Decimal"
          - column: "*.weight"
            go_type: "github.com/shopspring/decimal.Decimal"

          # ---- JSON fields ----
          - db_type: "json"
            go_type: "json.RawMessage"
            nullable: true
